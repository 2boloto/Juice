<!--This file created 2.7.1997 14:34 by Claris Home Page version 2.0--><HTML><HEAD>   <TITLE>JuiceClock.html</TITLE>   <META NAME=GENERATOR CONTENT="Claris Home Page 2.0">   <X-SAS-WINDOW TOP=46 BOTTOM=736 LEFT=191 RIGHT=889></HEAD><BODY BGCOLOR="#FFFFFF"><PRE><FONT COLOR="#0000AF">MODULE</FONT> JuiceClock;&nbsp;   <FONT COLOR="#0000AF">IMPORT</FONT>       Math := JuiceMath, Applets := JuiceApplets,       Devices := JuiceDevices, Misc := JuiceMisc;	   <FONT COLOR="#0000AF">TYPE</FONT>      Applet = <FONT COLOR="#0000AF">POINTER TO</FONT> AppletDesc;      AppletDesc = <FONTCOLOR="#0000AF">RECORD</FONT> (Applets.AppletDesc)         hour, min, sec: <FONT COLOR="#0000AF">INTEGER</FONT>	      <FONT COLOR="#0000AF">END</FONT>;&nbsp;   <FONT COLOR="#0000AF">PROCEDURE</FONT> Min(a, b: <FONTCOLOR="#0000AF">INTEGER</FONT>): <FONTCOLOR="#0000AF">INTEGER</FONT>;   <FONT COLOR="#0000AF">BEGIN      IF</FONT> a &lt; b <FONTCOLOR="#0000AF">THEN RETURN</FONT> a <FONTCOLOR="#0000AF">ELSE RETURN</FONT> b <FONT COLOR="#0000AF">END</FONT>   <FONT COLOR="#0000AF">END</FONT> Min;	   <FONTCOLOR="#0000AF">PROCEDURE</FONT> ArcLine(angle, x, y, r1, r2: <FONTCOLOR="#0000AF">INTEGER</FONT>; dot: <FONTCOLOR="#0000AF">BOOLEAN</FONT>);      <FONT COLOR="#0000AF">VAR</FONT> x1, y1, x2, y2: <FONTCOLOR="#0000AF">INTEGER</FONT>; s,c,a : <FONTCOLOR="#0000AF">REAL</FONT>;     <FONT COLOR="#0000AF">BEGIN</FONT>      angle := (angle-15) <FONT COLOR="#0000AF">MOD</FONT> 60;      a := 2 * Math.pi / 60 * angle;       s := Math.Sin(a); c := Math.Cos(a);      x1 := <FONT COLOR="#0000AF">SHORT</FONT>(<FONTCOLOR="#0000AF">ENTIER</FONT>(r1*c + 0.5));      y1 := <FONT COLOR="#0000AF">SHORT</FONT>(<FONTCOLOR="#0000AF">ENTIER</FONT>(r1*s + 0.5));      x2 := <FONT COLOR="#0000AF">SHORT</FONT>(<FONTCOLOR="#0000AF">ENTIER</FONT>(r2*c + 0.5));      y2 := <FONT COLOR="#0000AF">SHORT</FONT>(<FONTCOLOR="#0000AF">ENTIER</FONT>(r2*s + 0.5));      Devices.Line(x+x1, y+y1, x+x2, y+y2);      <FONT COLOR="#0000AF">IF</FONT> dot <FONTCOLOR="#0000AF">THEN</FONT> Devices.FillOval(x+x2-5, y+y2-5, 10, 10) <FONTCOLOR="#0000AF">END</FONT>   <FONT COLOR="#0000AF">END</FONT> ArcLine;	   <FONT COLOR="#0000AF">PROCEDURE</FONT> DoUpdate (me: Applet);      <FONTCOLOR="#0000AF">VAR</FONT> r, r0, rs, rm, rh, x, y, i: <FONTCOLOR="#0000AF">INTEGER</FONT>;     <FONT COLOR="#0000AF">BEGIN</FONT>      Devices.Setup(me.device);      r := Min(me.device.w, me.device.h) <FONTCOLOR="#0000AF">DIV</FONT> 2; r0 := 10*r <FONTCOLOR="#0000AF">DIV</FONT> 11;      rs := 8*r <FONT COLOR="#0000AF">DIV</FONT> 11; rm := 9*r <FONTCOLOR="#0000AF">DIV</FONT> 11; rh := 7*r <FONTCOLOR="#0000AF">DIV</FONT> 11; x := r; y := r;      Devices.SetForeColor(Devices.white);      Devices.FillRect(0, 0, me.device.w, me.device.h);      Devices.SetForeColor(Devices.black);       Devices.FrameOval(0, 0, 2*r, 2*r);      i := 0; <FONT COLOR="#0000AF">WHILE</FONT> i &lt; 60 <FONTCOLOR="#0000AF">DO</FONT> ArcLine(i, x, y, r0, r, <FONTCOLOR="#0000AF">FALSE</FONT>); <FONTCOLOR="#0000AF">INC</FONT>(i, 5) <FONT COLOR="#0000AF">END</FONT>;		      Misc.GetTime(me.hour, me.min, me.sec);      ArcLine(me.min, x, y, 0, rm, <FONTCOLOR="#0000AF">FALSE</FONT>);      ArcLine(me.hour * 5 + me.min <FONTCOLOR="#0000AF">DIV</FONT> 12, x, y, 0, rh, <FONTCOLOR="#0000AF">FALSE</FONT>);      Devices.SetForeColor(Devices.red);      ArcLine(me.sec, x, y, 0, rs, <FONTCOLOR="#0000AF">TRUE</FONT>);      Devices.Restore(me.device)   <FONT COLOR="#0000AF">END</FONT> DoUpdate;	   <FONT COLOR="#0000AF">PROCEDURE</FONT> DoIdle (me: Applet);      <FONT COLOR="#0000AF">VAR</FONT> hour, min, sec: <FONTCOLOR="#0000AF">INTEGER</FONT>;   <FONT COLOR="#0000AF">BEGIN</FONT>      Misc.GetTime(hour, min, sec);      <FONT COLOR="#0000AF">IF</FONT> (hour # me.hour) <FONTCOLOR="#0000AF">OR</FONT> (min # me.min) <FONTCOLOR="#0000AF">OR</FONT> (sec # me.sec) <FONTCOLOR="#0000AF">THEN</FONT> DoUpdate(me) <FONTCOLOR="#0000AF">END</FONT>   <FONT COLOR="#0000AF">END</FONT> DoIdle;		   <FONTCOLOR="#0000AF">PROCEDURE</FONT> AppletHandler (me: Applets.Applet; <FONTCOLOR="#0000AF">VAR</FONT> M: Applets.AppletMsg);   <FONT COLOR="#0000AF">BEGIN</FONT>      <FONT COLOR="#0000AF">WITH</FONT> me: Applet <FONTCOLOR="#0000AF">DO</FONT>         <FONTCOLOR="#0000AF">WITH</FONT> M: Applets.DisplayMsg <FONTCOLOR="#0000AF">DO</FONT>            <FONTCOLOR="#0000AF">IF</FONT> M.id = Applets.update <FONTCOLOR="#0000AF">THEN</FONT> DoUpdate(me)            <FONTCOLOR="#0000AF">ELSE</FONT> Applets.AppletHandler(me, M)            <FONT COLOR="#0000AF">END</FONT>         | M: Applets.IdleMsg DO DoIdle(me)         <FONTCOLOR="#0000AF">ELSE</FONT> Applets.AppletHandler(me, M)         <FONT COLOR="#0000AF">END      END</FONT>   <FONT COLOR="#0000AF">END</FONT> AppletHandler;	   <FONT COLOR="#0000AF">PROCEDURE</FONT> NewApplet*;      <FONT COLOR="#0000AF">VAR</FONT> a: Applet;   <FONTCOLOR="#0000AF">BEGIN NEW</FONT>(a); a.handle := AppletHandler; Applets.newApplet := a   <FONT COLOR="#0000AF">END</FONT> NewApplet;	<FONT COLOR="#0000AF">END</FONT> JuiceClock.</PRE></BODY></HTML>